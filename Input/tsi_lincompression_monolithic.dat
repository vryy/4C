//
// Maintainer: Christoph Meier
//
==================================================================
General Data File CCARAT
==================================================================
-----------------------------------------------------------------------TITLE
Simple test case for monolithic TSI: heating due to nodal velocities.
Compression of the body due to a traction force that increases with t
In contrast to corresponding partitioned TSI test cases, here we use a
dynamic time integration scheme for both fields
dynamic, geometrically linear analysis with THETA=1.0 (implicit Euler)
material parameters of steel
----------------------------------------------------------------PROBLEM SIZE
ELEMENTS                        2
NODES                           12
DIM                             3
MATERIALS                       4
NUMDF                           6
--------------------------------------------------------------DISCRETISATION
NUMSTRUCDIS                     1
NUMTHERMDIS                     1
--------------------------------------------------------------------------IO
FILESTEPS                       1000
OUTPUT_BIN                      Yes
STRUCT_DISP                     Yes  // Yes,No,yes,no,YES,NO
STRUCT_STRAIN                   GL  // No,no,NO,Yes,yes,YES,EA,ea,GL,gl
STRUCT_STRESS                   2PK  // No,no,NO,Yes,yes,YES,Cauchy,cauchy,2PK,2pk
STRUCT_COUPLING_STRESS          2PK  // No,no,NO,Yes,yes,YES,Cauchy,cauchy,2PK,2pk
THERM_HEATFLUX                  Initial  // None,No,NO,no,Current,Initial
THERM_TEMPERATURE               Yes  // Yes,No,yes,no,YES,NO
THERM_TEMPGRAD                  Initial  // None,No,NO,no,Current,Initial
-----------------------------------------------------------------PROBLEM TYP
PROBLEMTYP                      Thermo_Structure_Interaction
RESTART                         0
SHAPEFCT                        Polynomial
----------------------------------------------------------STRUCTURAL DYNAMIC
INT_STRATEGY                    Standard
ADAPTCONV                       No
ADAPTCONV_BETTER                0.1
DIVERCONT                       stop  // Yes,No,yes,no,YES,NO: Go on with time integration even if Newton-Raphson iteration failed
DYNAMICTYP                      OneStepTheta  // Centr_Diff,Gen_EMM,Gen_Alfa,Static,Statics,GenAlpha,OneStepTheta,GEMM,AdamsBashforth2,EulerMaruyama,EulerImpStoch
ITERNORM                        L2
LINEAR_SOLVER                   3
MAXITER                         50
MAXTIME                         1
MINITER                         0
NLNSOL                          fullnewton  // vague,fullnewton,lsnewton,oppnewton,modnewton,nlncg,ptc,newtonlinuzawa,augmentedlagrange,NoxNewtonLineSearch,noxgeneral
NORMCOMBI_RESFDISP              And
NORM_DISP                       Abs
NORM_RESF                       Abs
NUMSTEP                         200
PREDICT                         ConstDis  // Vague,ConstDis,ConstDisVelAcc,TangDis,ConstDisPres,ConstDisVelAccPres
RESULTSEVRY                     1
RESEVRYERGY                     0
RESTARTEVRY                     1
TIMESTEP                        1
TOLDISP                         1e-08
TOLRES                          1e-03  //5
YOUNG_IS_TEMP_DEPENDENT         No
---------------------------------------------STRUCTURAL DYNAMIC/ONESTEPTHETA
THETA                           1.0
-------------------------------------------------------------THERMAL DYNAMIC
ADAPTCONV                       No
ADAPTCONV_BETTER                0.1
DIVERCONT                       stop
DYNAMICTYP                      OneStepTheta  // Statics,OneStepTheta
INITFUNCNO                      1
INITIALFIELD                    field_by_function  // zero_field,field_by_function,field_by_condition
ITERNORM                        L2
LINEAR_SOLVER                   2
MAXITER                         50
MAXTIME                         1
MINITER                         0
NLNSOL                          fullnewton  // vague,fullnewton
NORMCOMBI_RESFTEMP              And
NORM_RESF                       Abs
NORM_TEMP                       Abs
NUMSTEP                         200
PREDICT                         ConstTemp  // Vague,ConstTemp,ConstTempRate,TangTemp
RESULTSEVRY                     1
RESTARTEVRY                     1
TIMESTEP                        0.01
TOLRES                          1e-05
TOLTEMP                         1e-07
------------------------------------------------THERMAL DYNAMIC/ONESTEPTHETA
THETA                           1.0  // 0.5
-----------------------------------------------------------------TSI DYNAMIC
COUPALGO                        tsi_monolithic  // tsi_{iterstagg{,_aitken,_aitkenirons,_fixedrelax},sequstagg,oneway}
ITEMAX                          10  // 100
ITEMIN                          1
MAXTIME                         1.0
NORM_INC                        Abs  // Rel,Mix
NUMSTEP                         2000
RESTARTEVRY                     1
TIMESTEP                        0.1
RESULTSEVRY                           1
---------------------------------------------TSI DYNAMIC/MONOLITHIC
TOLINC                          1e-07
ITERNORM                        Rms  // Rms,L2,Inf,L1_Scaled
LINEAR_SOLVER                   1
NORMCOMBI_RESFINC               Coupl_And_Singl  // Or,Coupl_Or_Singl,Coupl_And_Singl,And_Singl,Or_Singl
NORM_RESF                       Rel  // Rel,Mix
--------------------------------------------------------------------SOLVER 1
NAME                            TSI_MONOLITHIC_SOLVER
AZBDIAG                         0
AZCONV                          AZ_r0  // AZ_r0,AZ_rhs,AZ_Anorm,AZ_noscaled,AZ_sol,AZ_weighted,AZ_expected_values,AZTECOO_conv_test,AZ_inf_noscaled
AZDROP                          0
AZGRAPH                         0
AZITER                          1000
AZOMEGA                         0
AZOUTPUT                        0
AZPOLY                          3
AZPREC                          BGS2x2  // none,ILU,ILUT,Jacobi,SymmGaussSeidel,Least_Squares,Neumann,ICC,LU,RILU,BILU,ML,MLFLUID,MLFLUID2,MLAPI,GaussSeidel,DownwindGaussSeidel,AMG(Braess-Sarazin),AMG,BGS2x2
AZREUSE                         0
AZSCAL                          none  // none,sym,infnorm
AZSOLVE                         GMRES  // CG,GMRES,GMRESR,CGS,TFQMR,BiCGSTAB,LU
AZSUB                           300
AZTOL                           1e-08
DWINDTAU                        1.5
BGS2X2_FLIPORDER                block1_block0_order
IFPACKCOMBINE                   Add  // Add,Insert,Zero
IFPACKFILL                      1
IFPACKGFILL                     0
IFPACKOVERLAP                   0
ML_AGG_SIZE                     27
ML_COARSEN                      UC
ML_DAMPCOARSE                   1
ML_DAMPFINE                     1
ML_DAMPMED                      1
ML_MAXCOARSESIZE                1000
ML_MAXLEVEL                     5
ML_PRINT                        0
ML_PROLONG_SMO                  0
ML_PROLONG_THRES                0
ML_SMOOTHERCOARSE               Umfpack
ML_SMOOTHERFINE                 ILU
ML_SMOOTHERMED                  ILU
ML_SMOTIMES                     1 1 1 1 1
SOLVER                          Aztec_MSR  // UMFPACK,Amesos_KLU_sym,Amesos_KLU_nonsym,Superlu,vm3,LAPACK_sym,LAPACK_nonsym,UMFPACK
--------------------------------------------------------------------SOLVER 2
NAME                            THERMAL SOLVER
SOLVER                          UMFPACK  // Amesos_KLU_sym,Amesos_KLU_nonsym,Superlu,vm3,Aztec_MSR,LAPACK_sym,LAPACK_nonsym,UMFPACK
--------------------------------------------------------------------SOLVER 3
NAME                            STRUCTURAL SOLVER
SOLVER                          UMFPACK  // Amesos_KLU_sym,Amesos_KLU_nonsym,Superlu,vm3,Aztec_MSR,LAPACK_sym,LAPACK_nonsym,UMFPACK
-------------------------------------------------------------------MATERIALS
//parameters for steel [N,m,s,K]
MAT 1 MAT_Struct_ThrStVenantK YOUNGNUM 1 YOUNG 2.1e11 NUE 0.0 DENS 7850.0 THEXPANS 1.2e-05 CAPA 3297000.0 CONDUCT 52.0 INITTEMP 300.0
// CAPA = C_V* rho = 420*7850 = 3297000
MAT 2 THERM_FourierIso CAPA 3297000.0 CONDUCT 52.0
--------------------------------------------------------CLONING MATERIAL MAP
SRC_FIELD structure SRC_MAT 1 TAR_FIELD thermo TAR_MAT 2
----------------------------------------------------------------------FUNCT1
COMPONENT 0 FUNCTION 300.0
----------------------------------------------------------------------FUNCT2
COMPONENT 0 FUNCTION a
VARIABLE 0 NAME a TYPE multifunction NUMPOINTS 3 TIMES 0.0 1.0 500000.0 DESCRIPTION (-4.0e10*t) (-4.0e10*1)
----------------------------------------------------------DESIGN DESCRIPTION
NDPOINT                         0
NDLINE                          0
NDSURF                          4
NDVOL                           1
----------------------------------------------DESIGN SURF NEUMANN CONDITIONS
DSURF                           1
// right surface NEUMANN in x(x=4)
E 1 - NUMDOF 6 ONOFF 1 0 0 0 0 0 VAL 1.0 0.0 0.0 0.0 0.0 0.0 FUNCT 2 2 2 2 2 2 Live Mid
---------------------------------------DESIGN SURF THERMO NEUMANN CONDITIONS
DSURF                           2
// right THR NEUMANN q(x=4)
E 2 - NUMDOF 6 ONOFF 1 1 1 0 0 0 VAL 0.0 0.0 0.0 0.0 0.0 0.0 FUNCT 0 0 0 0 0 0 Live Mid
// left THR NEUMANN q(x=0)
E 3 - NUMDOF 6 ONOFF 1 1 1 0 0 0 VAL 0.0 0.0 0.0 0.0 0.0 0.0 FUNCT 0 0 0 0 0 0 Live Mid
-----------------------------------------------DESIGN SURF DIRICH CONDITIONS
DSURF                           1
// left surface fixed
E 4 - NUMDOF 3 ONOFF 1 1 1 VAL 0.0 0.0 0.0 FUNCT 0 0 0
------------------------------------------------DESIGN VOL DIRICH CONDITIONS
DVOL                            1
E 1 - NUMDOF 3 ONOFF 0 1 1 VAL 0.0 0.0 0.0 FUNCT 0 0 0
---------------------------------------------------------DSURF-NODE TOPOLOGY
NODE 9 DSURFACE 1
NODE 10 DSURFACE 1
NODE 11 DSURFACE 1
NODE 12 DSURFACE 1
NODE 9 DSURFACE 2
NODE 10 DSURFACE 2
NODE 11 DSURFACE 2
NODE 12 DSURFACE 2
NODE 1 DSURFACE 3
NODE 4 DSURFACE 3
NODE 5 DSURFACE 3
NODE 8 DSURFACE 3
NODE 1 DSURFACE 4
NODE 4 DSURFACE 4
NODE 5 DSURFACE 4
NODE 8 DSURFACE 4
----------------------------------------------------------DVOL-NODE TOPOLOGY
NODE 1 DVOL 1
NODE 2 DVOL 1
NODE 3 DVOL 1
NODE 4 DVOL 1
NODE 5 DVOL 1
NODE 6 DVOL 1
NODE 7 DVOL 1
NODE 8 DVOL 1
NODE 9 DVOL 1
NODE 10 DVOL 1
NODE 11 DVOL 1
NODE 12 DVOL 1
-----------------------------------------------------------------NODE COORDS
NODE 1 COORD 0.00000000e+00 0.00000000e+00 -1.00000000e+00
NODE 2 COORD 2.00000000e+00 0.00000000e+00 -1.00000000e+00
NODE 3 COORD 2.00000000e+00 2.00000000e+00 -1.00000000e+00
NODE 4 COORD 0.00000000e+00 2.00000000e+00 -1.00000000e+00
NODE 5 COORD 0.00000000e+00 0.00000000e+00 1.00000000e+00
NODE 6 COORD 2.00000000e+00 0.00000000e+00 1.00000000e+00
NODE 7 COORD 2.00000000e+00 2.00000000e+00 1.00000000e+00
NODE 8 COORD 0.00000000e+00 2.00000000e+00 1.00000000e+00
NODE 9 COORD 4.00000000e+00 0.00000000e+00 -1.00000000e+00
NODE 10 COORD 4.00000000e+00 2.00000000e+00 -1.00000000e+00
NODE 11 COORD 4.00000000e+00 0.00000000e+00 1.00000000e+00
NODE 12 COORD 4.00000000e+00 2.00000000e+00 1.00000000e+00
----------------------------------------------------------STRUCTURE ELEMENTS
1 SOLIDH8THERMO HEX8 1 2 3 4 5 6 7 8 MAT 1 KINEM linear EAS none
2 SOLIDH8THERMO HEX8 2 9 10 3 6 11 12 7 MAT 1 KINEM linear EAS none
----------------------------------------------------------RESULT DESCRIPTION
STRUCTURE DIS structure NODE 1 QUANTITY dispx VALUE 0 TOLERANCE 1e-9 NAME ux(x=0)
STRUCTURE DIS structure NODE 1 QUANTITY dispy VALUE 0 TOLERANCE 1e-9 NAME uy(x=0)
STRUCTURE DIS structure NODE 1 QUANTITY dispz VALUE 0 TOLERANCE 1e-9 NAME uz(x=0)
STRUCTURE DIS structure NODE 2 QUANTITY dispx VALUE -3.7981875658503556e-01 TOLERANCE 1e-9 NAME ux(x=2)
STRUCTURE DIS structure NODE 9 QUANTITY dispx VALUE -7.5963751317007100e-01 TOLERANCE 1e-9 NAME ux(x=4)
THERMAL DIS thermo NODE 1 QUANTITY temp VALUE 347.23435464012715 TOLERANCE 1.0e-8 NAME T(x=0)
THERMAL DIS thermo NODE 2 QUANTITY temp VALUE 347.23435464012715 TOLERANCE 1.0e-8 NAME T(x=2)
THERMAL DIS thermo NODE 9 QUANTITY temp VALUE 347.23435464012715 TOLERANCE 1.0e-8 NAME T(x=4)
-------------------------------------------------------------------------END
//  END