-------------------------------------------------------------------------TITLE
Prestressing

This is an arc made out of 7 HEX8 elements that is loaded with a orthopressure on the inner surface.
The prestress of the simulation if obtained iteratively in one constituent, while the other have a
predefined prestress. The simulation stopps after the residual displacements to the reference
configurations are below a certain tolerance.
-------------------------------------------------------------------PROBLEM TYP
PROBLEMTYP                      Structure
----------------------------------------------------------------------------IO
OUTPUT_BIN                      yes
STRUCT_DISP                     yes
FILESTEPS                       1000
VERBOSITY                       Standard
STRUCT_STRAIN                   gl
STRUCT_STRESS                   2pk
OUTPUT_SPRING                   Yes
---------------------------------------------------------IO/RUNTIME VTK OUTPUT
OUTPUT_DATA_FORMAT              binary
INTERVAL_STEPS                  1
EVERY_ITERATION                 no
-----------------------------------------------IO/RUNTIME VTK OUTPUT/STRUCTURE
OUTPUT_STRUCTURE                yes
DISPLACEMENT                    yes
ELEMENT_OWNER                   yes
STRESS_STRAIN                   yes
----------------------------------------------------------------------SOLVER 1
NAME                            Structure_Solver
SOLVER                          Superlu
------------------------------------------------------------STRUCTURAL DYNAMIC
INT_STRATEGY                    Standard
DYNAMICTYP                      Statics
RESULTSEVRY                     1
RESTARTEVRY                     1
TIMESTEP                        0.1
PRESTRESS                       material_iterative
PRESTRESSTIME                   100
PRESTRESSTOLDISP                1e-12
NUMSTEP                         1000
MAXTIME                         100
TOLDISP                         1e-11                         // 1e-09 mm
TOLRES                          1e-08                         // 1e-09 N
LINEAR_SOLVER                   1
NLNSOL                          fullnewton
LOADLIN                         yes
-----------------------------------------------------------STRUCT NOX/Printing
Outer Iteration                 = Yes
Inner Iteration                 = No
Outer Iteration StatusTest      = No
---------------------------------------------------------------------MATERIALS
// Units: [m] = 1.0 kg, [l] = 0.1 m, [t] = 1.0 s, [s] = 1.0 days
MAT 1 MAT_MixtureElastHyper NUMCONST 3 MATIDSCONST 11 12 14 MASSFRAC 0.3 0.1 0.6 MATIDMIXTURERULE 10 DENS 1.0000000000000002
MAT 10 MIX_GrowthRemodelMixtureRule GROWTH_TYPE 0
// Fiber of the cardiomyocytes
MAT 11 MIX_Constituent_ExplicitRemodelFiber MATID 110 DECAY_TIME 0.0 GROWTH_CONSTANT 1.0 DEPOSITION_STRETCH 0 DEPOSITION_STRETCH_TIMEFUNCT 1 GROWTH_ENABLED false
MAT 110 ELAST_CoupAnisoExpo K1 1016.6666666666664 K2 29.05 GAMMA 0.0 K1COMP 0.0 K2COMP 1.0 ADAPT_ANGLE No INIT 3 STR_TENS_ID 1000 FIBER_ID 1
// Collagen fibers in the direction of cardiomyocytes
MAT 12 MIX_Constituent_ExplicitRemodelFiber MATID 120 DECAY_TIME 0.0 GROWTH_CONSTANT 1.0 DEPOSITION_STRETCH 0 DEPOSITION_STRETCH_TIMEFUNCT 1 GROWTH_ENABLED false
MAT 120 ELAST_CoupAnisoExpo K1 1249.9999999999998 K2 36.65 GAMMA 0.0 K1COMP 0.0 K2COMP 1.0 ADAPT_ANGLE No INIT 3 STR_TENS_ID 1000 FIBER_ID 1
// 3D constituent with unknown prestretch
MAT 14 MIX_Constituent_ElastHyper NUMMAT 2 MATIDS 141 143 PRESTRESS_STRATEGY 149
MAT 141 ELAST_IsoExpoPow K1 66.66666666666666 K2 6.55 C 1
//MAT 142 ELAST_CoupAnisoExpoShear K1 249.99999999999994 K2 6.28 K1COMP 249.99999999999994 K2COMP 6.28 GAMMA 0.0 INIT 3 FIBER_IDS 1 2
MAT 143 ELAST_VolSussmanBathe KAPPA 1666.6666666666663
MAT 149 MIX_Prestress_Strategy_Iterative
// Structural tensor strategy
MAT 1000 ELAST_StructuralTensor STRATEGY Standard
------------------------------------------------------------------------FUNCT1
COMPONENT 0 FUNCTION a
VARIABLE 0 NAME a TYPE linearinterpolation NUMPOINTS 3 TIMES 0 1 9999999999.0 VALUES 1.0 1.06 1.06
------------------------------------------------------------------------FUNCT2
COMPONENT 0 FUNCTION a
VARIABLE 0 NAME a TYPE linearinterpolation NUMPOINTS 3 TIMES 0 1.0 9999999999.0 VALUES 0 1 1
------------------------------------------------DESIGN POINT DIRICH CONDITIONS
DPOINT                          1
E 1 - NUMDOF 6 ONOFF 1 1 0 0 0 0 VAL 0.0 0.0 0.0 0.0 0.0 0.0 FUNCT 0 0 0 0 0 0
//E 2 - NUMDOF 6 ONOFF 1 0 0 0 0 0 VAL 0.0 0.0 0.0 0.0 0.0 0.0 FUNCT 0 0 0 0 0 0
-------------------------------------------------DESIGN SURF DIRICH CONDITIONS
DSURF                           2
E 2 - NUMDOF 6 ONOFF 0 0 1 0 0 0 VAL 0.0 0.0 0.0 0.0 0.0 0.0 FUNCT 0 0 0 0 0 0
E 3 - NUMDOF 6 ONOFF 1 0 0 0 0 0 VAL 0.0 0.0 0.0 0.0 0.0 0.0 FUNCT 0 0 0 0 0 0
------------------------------------------------DESIGN SURF NEUMANN CONDITIONS
DSURF                           1
E 1 - NUMDOF 6 ONOFF 1 0 0 0 0 0 VAL -5.0 0.0 0.0 0.0 0.0 0.0 FUNCT 2 0 0 0 0 0 orthopressure Mid
------------------------------------------------------------RESULT DESCRIPTION
STRUCTURE DIS structure NODE 17 QUANTITY dispx VALUE 0 TOLERANCE 1e-9
STRUCTURE DIS structure NODE 17 QUANTITY dispy VALUE 0 TOLERANCE 1e-9
STRUCTURE DIS structure NODE 17 QUANTITY dispz VALUE 0 TOLERANCE 1e-9
------------------------------------------------------------------PROBLEM SIZE
ELEMENTS                        7
NODES                           32
DIM                             3
MATERIALS                       9999
------------------------------------------------------------DESIGN DESCRIPTION
NDPOINT                         2
NDLINE                          0
NDSURF                          3
NDVOL                           0
-----------------------------------------------------------DNODE-NODE TOPOLOGY
NODE 29 DNODE 1
NODE 32 DNODE 2
-----------------------------------------------------------DSURF-NODE TOPOLOGY
NODE 5 DSURFACE 1
NODE 13 DSURFACE 1
NODE 1 DSURFACE 1
NODE 21 DSURFACE 1
NODE 32 DSURFACE 1
NODE 16 DSURFACE 1
NODE 8 DSURFACE 1
NODE 24 DSURFACE 1
NODE 17 DSURFACE 1
NODE 29 DSURFACE 1
NODE 28 DSURFACE 1
NODE 9 DSURFACE 1
NODE 25 DSURFACE 1
NODE 4 DSURFACE 1
NODE 20 DSURFACE 1
NODE 12 DSURFACE 1
NODE 1 DSURFACE 2
NODE 2 DSURFACE 2
NODE 3 DSURFACE 2
NODE 4 DSURFACE 2
NODE 29 DSURFACE 3
NODE 31 DSURFACE 3
NODE 32 DSURFACE 3
NODE 30 DSURFACE 3
-------------------------------------------------------------------NODE COORDS
FNODE 1 COORD 1.0 1.0 0.0 FIBER1 0.0 0.0 1.0 FIBER2 0.0 1.0 0.0
FNODE 2 COORD -1.0 1.0 0.0 FIBER1 0.0 0.0 1.0 FIBER2 0.0 1.0 0.0
FNODE 3 COORD -1.0 -1.0 0.0 FIBER1 0.0 0.0 1.0 FIBER2 0.0 1.0 0.0
FNODE 4 COORD 1.0 -1.0 0.0 FIBER1 0.0 0.0 1.0 FIBER2 0.0 1.0 0.0
FNODE 5 COORD 1.2256487903635893 1.0 2.0026884056068295 FIBER1 0.22252093395631442 0.0 0.9749279121818236 FIBER2 0.0 1.0 0.0
FNODE 6 COORD -0.7242070340000595 1.0 2.4477302735194577 FIBER1 0.22252093395631434 0.0 0.9749279121818236 FIBER2 0.0 1.0 0.0
FNODE 7 COORD -0.7242070340000595 -1.0 2.4477302735194577 FIBER1 0.22252093395631434 0.0 0.9749279121818236 FIBER2 0.0 1.0 0.0
FNODE 8 COORD 1.2256487903635893 -1.0 2.0026884056068295 FIBER1 0.22252093395631442 0.0 0.9749279121818236 FIBER2 0.0 1.0 0.0
FNODE 9 COORD 1.8912801888782287 1.0 3.9049536520580226 FIBER1 0.4338837391175581 0.0 0.9009688679024191 FIBER2 0.0 1.0 0.0
FNODE 10 COORD 0.08934245307339062 1.0 4.772721130293139 FIBER1 0.4338837391175581 0.0 0.9009688679024191 FIBER2 0.0 1.0 0.0
FNODE 11 COORD 0.08934245307339062 -1.0 4.772721130293139 FIBER1 0.4338837391175581 0.0 0.9009688679024191 FIBER2 0.0 1.0 0.0
FNODE 12 COORD 1.8912801888782287 -1.0 3.9049536520580226 FIBER1 0.4338837391175581 0.0 0.9009688679024191 FIBER2 0.0 1.0 0.0
FNODE 13 COORD 2.963516657787733 1.0 5.6114082167286 FIBER1 0.6234898018587335 0.0 0.7818314824680298 FIBER2 0.0 1.0 0.0
FNODE 14 COORD 1.3998536928516714 1.0 6.858387820446067 FIBER1 0.6234898018587334 0.0 0.7818314824680299 FIBER2 0.0 1.0 0.0
FNODE 15 COORD 1.3998536928516714 -1.0 6.858387820446067 FIBER1 0.6234898018587334 0.0 0.7818314824680299 FIBER2 0.0 1.0 0.0
FNODE 16 COORD 2.963516657787733 -1.0 5.6114082167286 FIBER1 0.6234898018587335 0.0 0.7818314824680298 FIBER2 0.0 1.0 0.0
FNODE 17 COORD 4.388591783271398 1.0 7.036483342212267 FIBER1 0.7818314824680297 0.0 0.6234898018587336 FIBER2 0.0 1.0 0.0
FNODE 18 COORD 3.1416121795539302 1.0 8.600146307148327 FIBER1 0.7818314824680297 0.0 0.6234898018587336 FIBER2 0.0 1.0 0.0
FNODE 19 COORD 3.1416121795539302 -1.0 8.600146307148327 FIBER1 0.7818314824680297 0.0 0.6234898018587336 FIBER2 0.0 1.0 0.0
FNODE 20 COORD 4.388591783271398 -1.0 7.036483342212267 FIBER1 0.7818314824680297 0.0 0.6234898018587336 FIBER2 0.0 1.0 0.0
FNODE 21 COORD 6.0950463479419765 1.0 8.108719811121771 FIBER1 0.9009688679024191 0.0 0.4338837391175582 FIBER2 0.0 1.0 0.0
FNODE 22 COORD 5.227278869706859 1.0 9.91065754692661 FIBER1 0.900968867902419 0.0 0.43388373911755834 FIBER2 0.0 1.0 0.0
FNODE 23 COORD 5.227278869706859 -1.0 9.91065754692661 FIBER1 0.900968867902419 0.0 0.43388373911755834 FIBER2 0.0 1.0 0.0
FNODE 24 COORD 6.0950463479419765 -1.0 8.108719811121771 FIBER1 0.9009688679024191 0.0 0.4338837391175582 FIBER2 0.0 1.0 0.0
FNODE 25 COORD 7.99731159439317 1.0 8.77435120963641 FIBER1 0.9749279121818236 0.0 0.22252093395631445 FIBER2 0.0 1.0 0.0
FNODE 26 COORD 7.552269726480539 1.0 10.72420703400006 FIBER1 0.9749279121818235 0.0 0.22252093395631467 FIBER2 0.0 1.0 0.0
FNODE 27 COORD 7.552269726480539 -1.0 10.72420703400006 FIBER1 0.9749279121818235 0.0 0.22252093395631467 FIBER2 0.0 1.0 0.0
FNODE 28 COORD 7.99731159439317 -1.0 8.77435120963641 FIBER1 0.9749279121818236 0.0 0.22252093395631445 FIBER2 0.0 1.0 0.0
FNODE 29 COORD 10.0 1.0 9.0 FIBER1 1.0 0.0 6.123233995736766e-17 FIBER2 0.0 1.0 0.0
FNODE 30 COORD 10.0 1.0 11.0 FIBER1 1.0 0.0 6.123233995736766e-17 FIBER2 0.0 1.0 0.0
FNODE 31 COORD 10.0 -1.0 11.0 FIBER1 1.0 0.0 6.123233995736766e-17 FIBER2 0.0 1.0 0.0
FNODE 32 COORD 10.0 -1.0 9.0 FIBER1 1.0 0.0 6.123233995736766e-17 FIBER2 0.0 1.0 0.0
------------------------------------------------------------STRUCTURE ELEMENTS
1 SOLIDH8 HEX8 1 2 3 4 5 6 7 8 MAT 1 KINEM nonlinear EAS none
2 SOLIDH8 HEX8 5 6 7 8 9 10 11 12 MAT 1 KINEM nonlinear EAS none
3 SOLIDH8 HEX8 9 10 11 12 13 14 15 16 MAT 1 KINEM nonlinear EAS none
4 SOLIDH8 HEX8 13 14 15 16 17 18 19 20 MAT 1 KINEM nonlinear EAS none
5 SOLIDH8 HEX8 17 18 19 20 21 22 23 24 MAT 1 KINEM nonlinear EAS none
6 SOLIDH8 HEX8 21 22 23 24 25 26 27 28 MAT 1 KINEM nonlinear EAS none
7 SOLIDH8 HEX8 25 26 27 28 29 30 31 32 MAT 1 KINEM nonlinear EAS none
---------------------------------------------------------------------------END
