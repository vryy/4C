//
//
//
//
==================================================================
General Data File BACI
==================================================================
-------------------------------------------------------------TITLE
Test for line-based coupling between artery network and porofluid-
multiphase-problem
here, especially coupling with radius depending on porofluid-
quantities is tested with SYMBOLIC_FUNCTION_OF_SPACE_TIME 2 which prescribes radius
via quadratic pressure profile p3
radius of artery elements follows function
0.375+100*(y-0.05)*(y+0.05)
------------------------------------------------------PROBLEM SIZE
//ELEMENTS    38
//NODES       49
DIM           2
-----------------------------------------------------------------PROBLEM TYP
PROBLEMTYP                      Multiphase_Porous_Flow
RESTART                         0
---------------------------------------------POROFLUIDMULTIPHASE DYNAMIC
TIMEINTEGR                      One_Step_Theta
THETA                           1.0
LINEAR_SOLVER                   1
FDCHECK                         none
FDCHECKTOL                      1e-5
FDCHECKEPS                      1e-7
INITIALFIELD                    field_by_function
INITFUNCNO                      1
ITEMAX                          10
RESTARTEVRY                     1
RESULTSEVRY                     1
NUMSTEP                         2
MAXTIME                         0.2
TIMESTEP                        0.1
FLUX_PROJ_METHOD                none
OUTPUT_POROSITY                 no
ARTERY_COUPLING                 yes
-----------------------------POROFLUIDMULTIPHASE DYNAMIC/ARTERY COUPLING
ARTERY_COUPLING_METHOD          GPTS
SCALEREAC_ART                   1
REACFUNCT_ART                   4
SCALEREAC_CONT                  0 0 0
REACFUNCT_CONT                  0 0 0
------------------------------------------------------------ARTERIAL DYNAMIC
LINEAR_SOLVER                   1
DYNAMICTYP                      Stationary
NUMSTEP                         1
TIMESTEP                        0.1
RESTARTEVRY                     20
RESULTSEVRY                     20
SOLVESCATRA                     no
--------------------------------------------------------------------SOLVER 1
NAME                            Solver
SOLVER                          UMFPACK
-------------------------------------------------------------------MATERIALS
MAT 1 MAT_FluidPoroMultiPhase LOCAL No PERMEABILITY 1.0 NUMMAT 3 MATIDS 10 11 12 NUMFLUIDPHASES_IN_MULTIPHASEPORESPACE 3 END

MAT 10 MAT_FluidPoroSinglePhase DOFTYPEID 101 VISCOSITYLAWID 104 DENSITYLAWID 103 DENSITY 1.0 RELPERMEABILITYLAWID 105
MAT 101 MAT_FluidPoroSinglePhaseDofSaturation PHASELAWID 102
MAT 102 MAT_PhaseLawTangent NUMDOF 3 PRESCOEFF -1 1 0 END RELTENSION 0.02 EXP 1.0 SATURATION_0 0.1
MAT 103 MAT_PoroDensityLawExp BULKMODULUS 100.0
MAT 104 MAT_FluidPoroViscosityLawConstant VALUE 0.01
MAT 105 MAT_FluidPoroRelPermeabilityLawConstant VALUE  1.0

MAT 11 MAT_FluidPoroSinglePhase DOFTYPEID 111 VISCOSITYLAWID 104 DENSITYLAWID 113 DENSITY 1.0 RELPERMEABILITYLAWID 105
MAT 111 MAT_FluidPoroSinglePhaseDofDiffPressure PHASELAWID 112 NUMDOF 3 PRESCOEFF 0 1 -1 END
MAT 112 MAT_PhaseLawTangent NUMDOF 3 PRESCOEFF 0 -1  1 END RELTENSION 0.005 EXP 1.0 SATURATION_0 0.2
MAT 113 MAT_PoroDensityLawExp BULKMODULUS 100.0

MAT 12 MAT_FluidPoroSinglePhase DOFTYPEID 121 VISCOSITYLAWID 104 DENSITYLAWID 123 DENSITY 10.0 RELPERMEABILITYLAWID 105
MAT 121 MAT_FluidPoroSinglePhaseDofPressure PHASELAWID 122
MAT 122 MAT_PhaseLawConstraint
MAT 123 MAT_PoroDensityLawExp BULKMODULUS 100.0

MAT 2 MAT_StructPoro MATID 20 POROLAWID 200 INITPOROSITY 0.7
MAT 20 MAT_Struct_StVenantKirchhoff YOUNG 10.0 NUE 0.35 DENS 0.1
MAT 200 MAT_PoroLawDensityDependent DENSITYLAWID 201
MAT 201 MAT_PoroDensityLawExp BULKMODULUS 1e15

MAT 3 MAT_CNST_ART VISCOSITY 1.0 DENS 1.0 YOUNG 400000.0 NUE 0.5 TH 1.630 PEXT1 0.0 PEXT2 0.0 VARYING_DIAMETERLAW BY_FUNCTION VARYING_DIAMETER_FUNCTION 2
--------------------------------------------------------CLONING MATERIAL MAP
SRC_FIELD porofluid SRC_MAT 1 TAR_FIELD structure TAR_MAT 2
----------------------------------------------------------------------FUNCT1
COMPONENT 0 SYMBOLIC_FUNCTION_OF_SPACE_TIME 0.1
COMPONENT 1 SYMBOLIC_FUNCTION_OF_SPACE_TIME 0.0
COMPONENT 2 SYMBOLIC_FUNCTION_OF_SPACE_TIME 0.0
----------------------------------------------------------------------FUNCT2
VARFUNCTION 1-p3/4
----------------------------------------------------------------------FUNCT3
SYMBOLIC_FUNCTION_OF_SPACE_TIME (-400*(y-0.05)*(y+0.05)+1)*t/0.2
----------------------------------------------------------------------FUNCT4
VARFUNCTION 0.0
------------------------------------------------DESIGN DESCRIPTION
NDPOINT 2
NDLINE  0
NDSURF  1
NDVOL   0
-------------------------------------DESIGN SURF DIRICH CONDITIONS
DSURF  1
// top
E 1 - NUMDOF 3 ONOFF 1 1 1 VAL 0.0 0.0 1.0 FUNCT 0 0 3
---------------------------------------------DESIGN POINT DIRICH CONDITIONS
DPOINT 2
//inflow
E 1 - NUMDOF 1 ONOFF 1 VAL 1.0 FUNCT 0
//outflow
E 2 - NUMDOF 1 ONOFF 1 VAL 0.5 FUNCT 0
---------------------------------------------------------DNODE-NODE TOPOLOGY
NODE 29 DNODE 1
NODE 49 DNODE 2
-----------------------------------------------DSURF-NODE TOPOLOGY
NODE    1 DSURFACE 1
NODE    2 DSURFACE 1
NODE    3 DSURFACE 1
NODE    4 DSURFACE 1
NODE    5 DSURFACE 1
NODE    6 DSURFACE 1
NODE    7 DSURFACE 1
NODE    8 DSURFACE 1
NODE    9 DSURFACE 1
NODE    10 DSURFACE 1
NODE    11 DSURFACE 1
NODE    12 DSURFACE 1
NODE    13 DSURFACE 1
NODE    14 DSURFACE 1
NODE    15 DSURFACE 1
NODE    16 DSURFACE 1
NODE    17 DSURFACE 1
NODE    18 DSURFACE 1
NODE    19 DSURFACE 1
NODE    20 DSURFACE 1
NODE    21 DSURFACE 1
NODE    22 DSURFACE 1
NODE    23 DSURFACE 1
NODE    24 DSURFACE 1
NODE    25 DSURFACE 1
NODE    26 DSURFACE 1
NODE    27 DSURFACE 1
NODE    28 DSURFACE 1
-------------------------------------------------------NODE COORDS
NODE         1 COORD  2.5000000000000001e-02  5.0000000000000003e-02  0.0000000000000000e+00
NODE         2 COORD -3.5714285714285726e-03  5.0000000000000003e-02  0.0000000000000000e+00
NODE         3 COORD  8.6794175874718629e-04  2.9282938459179800e-02  0.0000000000000000e+00
NODE         4 COORD  2.5000000000000001e-02  3.3333333333333326e-02  0.0000000000000000e+00
NODE         5 COORD -1.7857142857142856e-02  5.0000000000000003e-02  0.0000000000000000e+00
NODE         6 COORD -1.2921805807682991e-02  2.6968427102520634e-02  0.0000000000000000e+00
NODE         7 COORD -2.5000000000000001e-02  5.0000000000000003e-02  0.0000000000000000e+00
NODE         8 COORD -2.5000000000000001e-02  2.4941187844413657e-02  0.0000000000000000e+00
NODE         9 COORD  4.6699336984721788e-03  1.1540309407129815e-02  0.0000000000000000e+00
NODE        10 COORD  2.5000000000000001e-02  1.6666666666666663e-02  0.0000000000000000e+00
NODE        11 COORD -8.8834438358797001e-03  8.1227379007719151e-03  0.0000000000000000e+00
NODE        12 COORD -2.5000000000000001e-02  4.0588443814250294e-03  0.0000000000000000e+00
NODE        13 COORD  8.1087774915791534e-03 -4.5076282940360590e-03  0.0000000000000000e+00
NODE        14 COORD  2.5000000000000001e-02  0.0000000000000000e+00  0.0000000000000000e+00
NODE        15 COORD -5.4042005151575170e-03 -8.1137309292649111e-03  0.0000000000000000e+00
NODE        16 COORD -2.5000000000000001e-02 -1.3343108504398821e-02  0.0000000000000000e+00
NODE        17 COORD  1.1367370608418307e-02 -1.9714396172618755e-02  0.0000000000000000e+00
NODE        18 COORD  2.5000000000000001e-02 -1.6666666666666670e-02  0.0000000000000000e+00
NODE        19 COORD -2.2652587831633840e-03 -2.2762125678570850e-02  0.0000000000000000e+00
NODE        20 COORD -2.5000000000000001e-02 -2.7844735909252030e-02  0.0000000000000000e+00
NODE        21 COORD  1.4580269299217625e-02 -3.4707923396348914e-02  0.0000000000000000e+00
NODE        22 COORD  2.5000000000000001e-02 -3.3333333333333340e-02  0.0000000000000000e+00
NODE        23 COORD  6.8729503150778345e-04 -3.6540710147036325e-02  0.0000000000000000e+00
NODE        24 COORD -2.5000000000000001e-02 -3.9929425413296374e-02  0.0000000000000000e+00
NODE        25 COORD  1.7857142857142856e-02 -5.0000000000000003e-02  0.0000000000000000e+00
NODE        26 COORD  2.5000000000000001e-02 -5.0000000000000003e-02  0.0000000000000000e+00
NODE        27 COORD  3.5714285714285726e-03 -5.0000000000000003e-02  0.0000000000000000e+00
NODE        28 COORD -2.5000000000000001e-02 -5.0000000000000003e-02  0.0000000000000000e+00
NODE 29 COORD 0 -0.06 0
NODE 30 COORD 0 -0.054 0
NODE 31 COORD 0 -0.048 0
NODE 32 COORD 0 -0.042 0
NODE 33 COORD 0 -0.036 0
NODE 34 COORD 0 -0.03 0
NODE 35 COORD 0 -0.024 0
NODE 36 COORD 0 -0.018 0
NODE 37 COORD 0 -0.012 0
NODE 38 COORD 0 -0.006 0
NODE 39 COORD 0 0 0
NODE 40 COORD 0 0.006 0
NODE 41 COORD 0 0.012 0
NODE 42 COORD 0 0.018 0
NODE 43 COORD 0 0.024 0
NODE 44 COORD 0 0.03 0
NODE 45 COORD 0 0.036 0
NODE 46 COORD 0 0.042 0
NODE 47 COORD 0 0.048 0
NODE 48 COORD 0 0.054 0
NODE 49 COORD 0 0.06 0
------------------------------------------------FLUID ELEMENTS
   1 POROFLUIDMULTIPHASE QUAD4  1 2 3 4    MAT 1
   2 POROFLUIDMULTIPHASE QUAD4  2 5 6 3    MAT 1
   3 POROFLUIDMULTIPHASE QUAD4  5 7 8 6    MAT 1
   4 POROFLUIDMULTIPHASE QUAD4  4 3 9 10    MAT 1
   5 POROFLUIDMULTIPHASE QUAD4  3 6 11 9    MAT 1
   6 POROFLUIDMULTIPHASE QUAD4  6 8 12 11    MAT 1
   7 POROFLUIDMULTIPHASE QUAD4  10 9 13 14    MAT 1
   8 POROFLUIDMULTIPHASE QUAD4  9 11 15 13    MAT 1
   9 POROFLUIDMULTIPHASE QUAD4  11 12 16 15    MAT 1
   10 POROFLUIDMULTIPHASE QUAD4  14 13 17 18    MAT 1
   11 POROFLUIDMULTIPHASE QUAD4  13 15 19 17    MAT 1
   12 POROFLUIDMULTIPHASE QUAD4  15 16 20 19    MAT 1
   13 POROFLUIDMULTIPHASE QUAD4  18 17 21 22    MAT 1
   14 POROFLUIDMULTIPHASE QUAD4  17 19 23 21    MAT 1
   15 POROFLUIDMULTIPHASE QUAD4  19 20 24 23    MAT 1
   16 POROFLUIDMULTIPHASE QUAD4  22 21 25 26    MAT 1
   17 POROFLUIDMULTIPHASE QUAD4  21 23 27 25    MAT 1
   18 POROFLUIDMULTIPHASE QUAD4  23 24 28 27    MAT 1
-------------------------------------------------------------ARTERY ELEMENTS
1 ART LINE2 29 30 MAT 3 GP 3 TYPE PressureBased DIAM 1.0
2 ART LINE2 30 31 MAT 3 GP 3 TYPE PressureBased DIAM 1.0
3 ART LINE2 31 32 MAT 3 GP 3 TYPE PressureBased DIAM 1.0
4 ART LINE2 32 33 MAT 3 GP 3 TYPE PressureBased DIAM 1.0
5 ART LINE2 33 34 MAT 3 GP 3 TYPE PressureBased DIAM 1.0
6 ART LINE2 34 35 MAT 3 GP 3 TYPE PressureBased DIAM 1.0
7 ART LINE2 35 36 MAT 3 GP 3 TYPE PressureBased DIAM 1.0
8 ART LINE2 36 37 MAT 3 GP 3 TYPE PressureBased DIAM 1.0
9 ART LINE2 37 38 MAT 3 GP 3 TYPE PressureBased DIAM 1.0
10 ART LINE2 38 39 MAT 3 GP 3 TYPE PressureBased DIAM 1.0
11 ART LINE2 39 40 MAT 3 GP 3 TYPE PressureBased DIAM 1.0
12 ART LINE2 40 41 MAT 3 GP 3 TYPE PressureBased DIAM 1.0
13 ART LINE2 41 42 MAT 3 GP 3 TYPE PressureBased DIAM 1.0
14 ART LINE2 42 43 MAT 3 GP 3 TYPE PressureBased DIAM 1.0
15 ART LINE2 43 44 MAT 3 GP 3 TYPE PressureBased DIAM 1.0
16 ART LINE2 44 45 MAT 3 GP 3 TYPE PressureBased DIAM 1.0
17 ART LINE2 45 46 MAT 3 GP 3 TYPE PressureBased DIAM 1.0
18 ART LINE2 46 47 MAT 3 GP 3 TYPE PressureBased DIAM 1.0
19 ART LINE2 47 48 MAT 3 GP 3 TYPE PressureBased DIAM 1.0
20 ART LINE2 48 49 MAT 3 GP 3 TYPE PressureBased DIAM 1.0
----------------------------------------------------------RESULT DESCRIPTION
ARTNET DIS artery ELEMENT 1 QUANTITY radius VALUE 5.00000000000000000e-01 TOLERANCE 1.0e-14
ARTNET DIS artery ELEMENT 2 QUANTITY radius VALUE 4.56885943759155200e-01 TOLERANCE 1.0e-14
ARTNET DIS artery ELEMENT 5 QUANTITY radius VALUE 3.06278456468071836e-01 TOLERANCE 1.0e-14
ARTNET DIS artery ELEMENT 14 QUANTITY radius VALUE 2.76087560203845561e-01 TOLERANCE 1.0e-14
ARTNET DIS artery ELEMENT 19 QUANTITY radius VALUE 4.57005508085766510e-01 TOLERANCE 1.0e-14
ARTNET DIS artery ELEMENT 20 QUANTITY radius VALUE 5.00000000000000000e-01 TOLERANCE 1.0e-14
ARTNET DIS artery ELEMENT 3 QUANTITY volflow VALUE 1.25608856053912518e-02 TOLERANCE 1.0e-13 // has to be equal throughout domain
ARTNET DIS artery ELEMENT 7 QUANTITY volflow VALUE 1.25608856053912518e-02 TOLERANCE 1.0e-13 // has to be equal throughout domain
ARTNET DIS artery NODE 33 QUANTITY pressure VALUE 9.63502368725529079e-01 TOLERANCE 1.0e-14
ARTNET DIS artery NODE 45 QUANTITY pressure VALUE 5.35466607101896863e-01 TOLERANCE 1.0e-14
---------------------------------------------------------------END
// END