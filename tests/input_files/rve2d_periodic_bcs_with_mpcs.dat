-------------------------------------------------------------TITLE
Test if periodic boundary conditions work correctly for 2D problems
when the displacement reference vector is defined manually.
Test linear coupled equation conditions.
------------------------------------------------------PROBLEM SIZE
//ELEMENTS    45
//NODES       64
DIM           2
--------------------------------------------------------------------PROBLEM TYP
PROBLEMTYP                      Structure
RESTART                         0

--------------------------------------------------------------------DISCRETISATION
NUMFLUIDDIS                     0
NUMSTRUCDIS                     1
NUMALEDIS                       0
NUMTHERMDIS                     0
--------------------------------------------MULTI POINT CONSTRAINTS
ENFORCEMENT			penalty_method
PENALTY_PARAM			1.0E08
RVE_REFERENCE_POINTS		manual
--------------------------------------------------------------------STRUCTURAL DYNAMIC
LINEAR_SOLVER                   1
DYNAMICTYP                      Statics
RESULTSEVRY                     1
RESTARTEVRY                     1
NLNSOL                          fullnewton
TIMESTEP                        1.0
NUMSTEP                         1
MAXTIME                         1.0
DAMPING                         no
TOLRES                          1.0E-5
TOLDISP                         1.0E-5
NORM_RESF                       Abs
NORM_DISP                       Abs
NORMCOMBI_RESFDISP              And
MAXITER                         10
INT_STRATEGY                    Standard
--------------------------------------------------------------------STRUCTURAL DYNAMIC/GENALPHA
GENAVG                          TrLike
RHO_INF                         1.0
--------------------------------------------------------------------SOLVER 1
NAME                            Structure_Solver
SOLVER                          UMFPACK
-------------------------------------------------------------------MATERIALS
MAT 2 MAT_Struct_StVenantKirchhoff YOUNG 100.0 NUE 0.3 DENS 0.5
--------------------------------------------------------------------FUNCT1
COMPONENT 0 SYMBOLIC_FUNCTION_OF_SPACE_TIME a
VARIABLE 0 NAME a TYPE linearinterpolation NUMPOINTS 2 TIMES 0 1 VALUES 0 1

------------------------------------DESIGN POINT DIRICH CONDITIONS
DPOINT 3
// N1
E 1 - NUMDOF 2 ONOFF 1 1 VAL 0.0 0.0 FUNCT 1 1
// N2
E 2 - NUMDOF 2 ONOFF 1 1 VAL 1.0 1.0 FUNCT 1 1
// N1B@RVE
E 5 - NUMDOF 2 ONOFF 1 1 VAL 0.0 0.0 FUNCT 1 1
----------------------DESIGN LINE PERIODIC RVE 2D BOUNDARY CONDITIONS
DLINE  4
// top
E 1 - EDGE y+
// left
E 2 - EDGE x-
// bottom
E 3 - EDGE y-
// right
E 4 - EDGE x+
-----------DESIGN POINT PERIODIC RVE 2D BOUNDARY REFERENCE CONDITIONS
DPOINT 4
// N1L
E 1 - POSITION N1L
// N1B
E 1 - POSITION N1B
// N2
E 2 - POSITION N2
// N4
E 4 - POSITION N4
-----------DESIGN POINT COUPLED DOF EQUATION CONDITIONS
DPOINT 6
E 3 - EQUATION 1 ADD dispx COEFFICIENT 1.0
E 2 - EQUATION 1 ADD dispx COEFFICIENT -1.0
E 4 - EQUATION 1 ADD dispx COEFFICIENT -1.0
E 3 - EQUATION 2 ADD dispy COEFFICIENT 1.0
E 2 - EQUATION 2 ADD dispy COEFFICIENT -1.0
E 4 - EQUATION 2 ADD dispy COEFFICIENT -1.0
-------------------------------------------------DNODE-NODE TOPOLOGY
NODE    65 DNODE 1 // N1L & N1B
NODE    66 DNODE 2 // N2
NODE    67 DNODE 3 // N3
NODE    68 DNODE 4 // N4
NODE	64 DNODE 5 // N1B_RVE
-----------------------------------------------DLINE-NODE TOPOLOGY
NODE    33 DLINE 1
NODE    34 DLINE 1
NODE    37 DLINE 1
NODE    39 DLINE 1
NODE    7 DLINE 2
NODE    8 DLINE 2
NODE    12 DLINE 2
NODE    16 DLINE 2
NODE    61 DLINE 3
NODE    62 DLINE 3
NODE    63 DLINE 3
NODE    64 DLINE 3
NODE    23 DLINE 4
NODE    24 DLINE 4
NODE    28 DLINE 4
NODE    32 DLINE 4
-----------------------------------------------DSURF-NODE TOPOLOGY
------------------------------------------------DVOL-NODE TOPOLOGY
-------------------------------------------------------NODE COORDS
NODE         1 COORD  2.0000000000000000e+01  4.0000000000000000e+01  0.0000000000000000e+00
NODE         2 COORD  1.3333333333333336e+01  4.0000000000000000e+01  0.0000000000000000e+00
NODE         3 COORD  1.3333333333333336e+01  3.3333333333333336e+01  0.0000000000000000e+00
NODE         4 COORD  2.0000000000000000e+01  3.3333333333333336e+01  0.0000000000000000e+00
NODE         5 COORD  6.6666666666666643e+00  4.0000000000000000e+01  0.0000000000000000e+00
NODE         6 COORD  6.6666666666666572e+00  3.3333333333333336e+01  0.0000000000000000e+00
NODE         7 COORD  0.0000000000000000e+00  4.0000000000000000e+01  0.0000000000000000e+00
NODE         8 COORD  0.0000000000000000e+00  3.3333333333333336e+01  0.0000000000000000e+00
NODE         9 COORD  1.3333333333333332e+01  2.6666666666666668e+01  0.0000000000000000e+00
NODE        10 COORD  2.0000000000000000e+01  2.6666666666666668e+01  0.0000000000000000e+00
NODE        11 COORD  6.6666666666666643e+00  2.6666666666666664e+01  0.0000000000000000e+00
NODE        12 COORD  0.0000000000000000e+00  2.6666666666666664e+01  0.0000000000000000e+00
NODE        13 COORD  1.3333333333333334e+01  2.0000000000000000e+01  0.0000000000000000e+00
NODE        14 COORD  2.0000000000000000e+01  2.0000000000000000e+01  0.0000000000000000e+00
NODE        15 COORD  6.6666666666666670e+00  2.0000000000000000e+01  0.0000000000000000e+00
NODE        16 COORD  0.0000000000000000e+00  2.0000000000000000e+01  0.0000000000000000e+00
NODE        17 COORD  4.0000000000000000e+01  2.0000000000000000e+01  0.0000000000000000e+00
NODE        18 COORD  4.6666666666666664e+01  2.0000000000000000e+01  0.0000000000000000e+00
NODE        19 COORD  4.6666666666666671e+01  2.6666666666666668e+01  0.0000000000000000e+00
NODE        20 COORD  4.0000000000000000e+01  2.6666666666666668e+01  0.0000000000000000e+00
NODE        21 COORD  5.3333333333333336e+01  2.0000000000000000e+01  0.0000000000000000e+00
NODE        22 COORD  5.3333333333333329e+01  2.6666666666666668e+01  0.0000000000000000e+00
NODE        23 COORD  6.0000000000000000e+01  2.0000000000000000e+01  0.0000000000000000e+00
NODE        24 COORD  6.0000000000000000e+01  2.6666666666666668e+01  0.0000000000000000e+00
NODE        25 COORD  4.6666666666666664e+01  3.3333333333333336e+01  0.0000000000000000e+00
NODE        26 COORD  4.0000000000000000e+01  3.3333333333333336e+01  0.0000000000000000e+00
NODE        27 COORD  5.3333333333333336e+01  3.3333333333333336e+01  0.0000000000000000e+00
NODE        28 COORD  6.0000000000000000e+01  3.3333333333333336e+01  0.0000000000000000e+00
NODE        29 COORD  4.6666666666666664e+01  4.0000000000000000e+01  0.0000000000000000e+00
NODE        30 COORD  4.0000000000000000e+01  4.0000000000000000e+01  0.0000000000000000e+00
NODE        31 COORD  5.3333333333333336e+01  4.0000000000000000e+01  0.0000000000000000e+00
NODE        32 COORD  6.0000000000000000e+01  4.0000000000000000e+01  0.0000000000000000e+00
NODE        33 COORD  4.0000000000000000e+01  6.0000000000000000e+01  0.0000000000000000e+00
NODE        34 COORD  3.3333333333333336e+01  6.0000000000000000e+01  0.0000000000000000e+00
NODE        35 COORD  3.3333333333333336e+01  5.3333333333333343e+01  0.0000000000000000e+00
NODE        36 COORD  4.0000000000000000e+01  5.3333333333333336e+01  0.0000000000000000e+00
NODE        37 COORD  2.6666666666666664e+01  6.0000000000000000e+01  0.0000000000000000e+00
NODE        38 COORD  2.6666666666666664e+01  5.3333333333333336e+01  0.0000000000000000e+00
NODE        39 COORD  2.0000000000000000e+01  6.0000000000000000e+01  0.0000000000000000e+00
NODE        40 COORD  2.0000000000000000e+01  5.3333333333333336e+01  0.0000000000000000e+00
NODE        41 COORD  3.3333333333333336e+01  4.6666666666666657e+01  0.0000000000000000e+00
NODE        42 COORD  4.0000000000000000e+01  4.6666666666666664e+01  0.0000000000000000e+00
NODE        43 COORD  2.6666666666666664e+01  4.6666666666666664e+01  0.0000000000000000e+00
NODE        44 COORD  2.0000000000000000e+01  4.6666666666666664e+01  0.0000000000000000e+00
NODE        45 COORD  3.3333333333333336e+01  4.0000000000000000e+01  0.0000000000000000e+00
NODE        46 COORD  2.6666666666666664e+01  4.0000000000000000e+01  0.0000000000000000e+00
NODE        47 COORD  3.3333333333333336e+01  3.3333333333333336e+01  0.0000000000000000e+00
NODE        48 COORD  2.6666666666666664e+01  3.3333333333333336e+01  0.0000000000000000e+00
NODE        49 COORD  3.3333333333333336e+01  2.6666666666666668e+01  0.0000000000000000e+00
NODE        50 COORD  2.6666666666666668e+01  2.6666666666666668e+01  0.0000000000000000e+00
NODE        51 COORD  3.3333333333333336e+01  2.0000000000000000e+01  0.0000000000000000e+00
NODE        52 COORD  2.6666666666666668e+01  1.9999999999999996e+01  0.0000000000000000e+00
NODE        53 COORD  3.3333333333333336e+01  1.3333333333333339e+01  0.0000000000000000e+00
NODE        54 COORD  4.0000000000000000e+01  1.3333333333333334e+01  0.0000000000000000e+00
NODE        55 COORD  2.6666666666666668e+01  1.3333333333333343e+01  0.0000000000000000e+00
NODE        56 COORD  2.0000000000000000e+01  1.3333333333333336e+01  0.0000000000000000e+00
NODE        57 COORD  3.3333333333333336e+01  6.6666666666666643e+00  0.0000000000000000e+00
NODE        58 COORD  4.0000000000000000e+01  6.6666666666666670e+00  0.0000000000000000e+00
NODE        59 COORD  2.6666666666666668e+01  6.6666666666666572e+00  0.0000000000000000e+00
NODE        60 COORD  2.0000000000000000e+01  6.6666666666666643e+00  0.0000000000000000e+00
NODE        61 COORD  3.3333333333333336e+01  0.0000000000000000e+00  0.0000000000000000e+00
NODE        62 COORD  4.0000000000000000e+01  0.0000000000000000e+00  0.0000000000000000e+00
NODE        63 COORD  2.6666666666666668e+01  0.0000000000000000e+00  0.0000000000000000e+00
NODE        64 COORD  2.0000000000000000e+01  0.0000000000000000e+00  0.0000000000000000e+00
NODE        65 COORD  0.0000000000000000e+00  0.0000000000000000e+00  0.0000000000000000e+00
NODE        66 COORD  6.0000000000000000e+01  0.0000000000000000e+00  0.0000000000000000e+00
NODE        67 COORD  6.0000000000000000e+01  6.0000000000000000e+01  0.0000000000000000e+00
NODE        68 COORD  0.0000000000000000e+00  6.0000000000000000e+01  0.0000000000000000e+00
------------------------------------------------STRUCTURE ELEMENTS
   1 WALL QUAD4  1 2 3 4    MAT 2 KINEM nonlinear EAS none THICK 1.0 STRESS_STRAIN plane_stress GP 2 2
   2 WALL QUAD4  2 5 6 3    MAT 2 KINEM nonlinear EAS none THICK 1.0 STRESS_STRAIN plane_stress GP 2 2
   3 WALL QUAD4  5 7 8 6    MAT 2 KINEM nonlinear EAS none THICK 1.0 STRESS_STRAIN plane_stress GP 2 2
   4 WALL QUAD4  4 3 9 10    MAT 2 KINEM nonlinear EAS none THICK 1.0 STRESS_STRAIN plane_stress GP 2 2
   5 WALL QUAD4  3 6 11 9    MAT 2 KINEM nonlinear EAS none THICK 1.0 STRESS_STRAIN plane_stress GP 2 2
   6 WALL QUAD4  6 8 12 11    MAT 2 KINEM nonlinear EAS none THICK 1.0 STRESS_STRAIN plane_stress GP 2 2
   7 WALL QUAD4  10 9 13 14    MAT 2 KINEM nonlinear EAS none THICK 1.0 STRESS_STRAIN plane_stress GP 2 2
   8 WALL QUAD4  9 11 15 13    MAT 2 KINEM nonlinear EAS none THICK 1.0 STRESS_STRAIN plane_stress GP 2 2
   9 WALL QUAD4  11 12 16 15    MAT 2 KINEM nonlinear EAS none THICK 1.0 STRESS_STRAIN plane_stress GP 2 2
   10 WALL QUAD4  17 18 19 20    MAT 2 KINEM nonlinear EAS none THICK 1.0 STRESS_STRAIN plane_stress GP 2 2
   11 WALL QUAD4  18 21 22 19    MAT 2 KINEM nonlinear EAS none THICK 1.0 STRESS_STRAIN plane_stress GP 2 2
   12 WALL QUAD4  21 23 24 22    MAT 2 KINEM nonlinear EAS none THICK 1.0 STRESS_STRAIN plane_stress GP 2 2
   13 WALL QUAD4  20 19 25 26    MAT 2 KINEM nonlinear EAS none THICK 1.0 STRESS_STRAIN plane_stress GP 2 2
   14 WALL QUAD4  19 22 27 25    MAT 2 KINEM nonlinear EAS none THICK 1.0 STRESS_STRAIN plane_stress GP 2 2
   15 WALL QUAD4  22 24 28 27    MAT 2 KINEM nonlinear EAS none THICK 1.0 STRESS_STRAIN plane_stress GP 2 2
   16 WALL QUAD4  26 25 29 30    MAT 2 KINEM nonlinear EAS none THICK 1.0 STRESS_STRAIN plane_stress GP 2 2
   17 WALL QUAD4  25 27 31 29    MAT 2 KINEM nonlinear EAS none THICK 1.0 STRESS_STRAIN plane_stress GP 2 2
   18 WALL QUAD4  27 28 32 31    MAT 2 KINEM nonlinear EAS none THICK 1.0 STRESS_STRAIN plane_stress GP 2 2
   19 WALL QUAD4  33 34 35 36    MAT 2 KINEM nonlinear EAS none THICK 1.0 STRESS_STRAIN plane_stress GP 2 2
   20 WALL QUAD4  34 37 38 35    MAT 2 KINEM nonlinear EAS none THICK 1.0 STRESS_STRAIN plane_stress GP 2 2
   21 WALL QUAD4  37 39 40 38    MAT 2 KINEM nonlinear EAS none THICK 1.0 STRESS_STRAIN plane_stress GP 2 2
   22 WALL QUAD4  36 35 41 42    MAT 2 KINEM nonlinear EAS none THICK 1.0 STRESS_STRAIN plane_stress GP 2 2
   23 WALL QUAD4  35 38 43 41    MAT 2 KINEM nonlinear EAS none THICK 1.0 STRESS_STRAIN plane_stress GP 2 2
   24 WALL QUAD4  38 40 44 43    MAT 2 KINEM nonlinear EAS none THICK 1.0 STRESS_STRAIN plane_stress GP 2 2
   25 WALL QUAD4  42 41 45 30    MAT 2 KINEM nonlinear EAS none THICK 1.0 STRESS_STRAIN plane_stress GP 2 2
   26 WALL QUAD4  41 43 46 45    MAT 2 KINEM nonlinear EAS none THICK 1.0 STRESS_STRAIN plane_stress GP 2 2
   27 WALL QUAD4  43 44 1 46    MAT 2 KINEM nonlinear EAS none THICK 1.0 STRESS_STRAIN plane_stress GP 2 2
   28 WALL QUAD4  30 45 47 26    MAT 2 KINEM nonlinear EAS none THICK 1.0 STRESS_STRAIN plane_stress GP 2 2
   29 WALL QUAD4  45 46 48 47    MAT 2 KINEM nonlinear EAS none THICK 1.0 STRESS_STRAIN plane_stress GP 2 2
   30 WALL QUAD4  46 1 4 48    MAT 2 KINEM nonlinear EAS none THICK 1.0 STRESS_STRAIN plane_stress GP 2 2
   31 WALL QUAD4  26 47 49 20    MAT 2 KINEM nonlinear EAS none THICK 1.0 STRESS_STRAIN plane_stress GP 2 2
   32 WALL QUAD4  47 48 50 49    MAT 2 KINEM nonlinear EAS none THICK 1.0 STRESS_STRAIN plane_stress GP 2 2
   33 WALL QUAD4  48 4 10 50    MAT 2 KINEM nonlinear EAS none THICK 1.0 STRESS_STRAIN plane_stress GP 2 2
   34 WALL QUAD4  20 49 51 17    MAT 2 KINEM nonlinear EAS none THICK 1.0 STRESS_STRAIN plane_stress GP 2 2
   35 WALL QUAD4  49 50 52 51    MAT 2 KINEM nonlinear EAS none THICK 1.0 STRESS_STRAIN plane_stress GP 2 2
   36 WALL QUAD4  50 10 14 52    MAT 2 KINEM nonlinear EAS none THICK 1.0 STRESS_STRAIN plane_stress GP 2 2
   37 WALL QUAD4  17 51 53 54    MAT 2 KINEM nonlinear EAS none THICK 1.0 STRESS_STRAIN plane_stress GP 2 2
   38 WALL QUAD4  51 52 55 53    MAT 2 KINEM nonlinear EAS none THICK 1.0 STRESS_STRAIN plane_stress GP 2 2
   39 WALL QUAD4  52 14 56 55    MAT 2 KINEM nonlinear EAS none THICK 1.0 STRESS_STRAIN plane_stress GP 2 2
   40 WALL QUAD4  54 53 57 58    MAT 2 KINEM nonlinear EAS none THICK 1.0 STRESS_STRAIN plane_stress GP 2 2
   41 WALL QUAD4  53 55 59 57    MAT 2 KINEM nonlinear EAS none THICK 1.0 STRESS_STRAIN plane_stress GP 2 2
   42 WALL QUAD4  55 56 60 59    MAT 2 KINEM nonlinear EAS none THICK 1.0 STRESS_STRAIN plane_stress GP 2 2
   43 WALL QUAD4  58 57 61 62    MAT 2 KINEM nonlinear EAS none THICK 1.0 STRESS_STRAIN plane_stress GP 2 2
   44 WALL QUAD4  57 59 63 61    MAT 2 KINEM nonlinear EAS none THICK 1.0 STRESS_STRAIN plane_stress GP 2 2
   45 WALL QUAD4  59 60 64 63    MAT 2 KINEM nonlinear EAS none THICK 1.0 STRESS_STRAIN plane_stress GP 2 2
   46 WALL QUAD4  65 66 67 68    MAT 2 KINEM nonlinear EAS none THICK 0.0000001 STRESS_STRAIN plane_stress GP 2 2
------------------------------------------------------------RESULT DESCRIPTION
STRUCTURE DIS structure NODE 66 QUANTITY dispx VALUE 1.0 TOLERANCE 1e-6
STRUCTURE DIS structure NODE 66 QUANTITY dispy VALUE 1.0 TOLERANCE 1e-6
STRUCTURE DIS structure NODE 67 QUANTITY dispx VALUE 0.0187626 TOLERANCE 1e-6
STRUCTURE DIS structure NODE 67 QUANTITY dispy VALUE 0.8554800 TOLERANCE 1e-6
STRUCTURE DIS structure NODE 30 QUANTITY dispx VALUE -0.546802 TOLERANCE 1e-6
STRUCTURE DIS structure NODE 30 QUANTITY dispy VALUE 0.2174140 TOLERANCE 1e-6
---------------------------------------------------------------END
// END
